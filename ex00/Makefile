# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: lihrig <lihrig@student.42.fr>              +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2026/02/05 10:36:24 by lihrig            #+#    #+#              #
#    Updated: 2026/02/08 15:30:44 by lihrig           ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# ============================================================================ #
#                                 CONFIGURATION                                 #
# ============================================================================ #

# Name des finalen Programms
NAME        = fixed

# Compiler und Flags
CXX         = c++
CXXFLAGS    = -Wall -Wextra -Werror -std=c++98

# Source-Dateien
SRCS        = main.cpp \
			ClapTrap.cpp \

# Objekt-Dateien Ordner
OBJS_DIR    = objects

# Objekt-Dateien (automatisch generiert aus SRCS)
OBJS        = $(SRCS:.cpp=.o)

# Vollst√§ndige Pfade f√ºr Objekt-Dateien
OBJS_FULL   = $(addprefix $(OBJS_DIR)/, $(OBJS))

# ============================================================================ #
#                                   FARBEN                                      #
# ============================================================================ #

# ANSI Escape-Codes f√ºr Farben
RESET       = \033[0m
BOLD        = \033[1m
DIM         = \033[2m

# Farben
RED         = \033[31m
GREEN       = \033[32m
YELLOW      = \033[33m
BLUE        = \033[34m
MAGENTA     = \033[35m
CYAN        = \033[36m
WHITE       = \033[37m

# Hintergrundfarben
BG_GREEN    = \033[42m
BG_BLUE     = \033[44m

# ============================================================================ #
#                                 PROGRESS BAR                                  #
# ============================================================================ #

# Z√§hler f√ºr kompilierte Dateien
COMPILED    = 0
TOTAL       = $(words $(SRCS))

# Fortschrittsbalken-Funktion
define progress_bar
	$(eval COMPILED=$(shell echo $$(($(COMPILED)+1))))
	$(eval PERCENT=$(shell echo $$(($(COMPILED)*100/$(TOTAL)))))
	$(eval FILLED=$(shell echo $$(($(PERCENT)/5))))
	$(eval EMPTY=$(shell echo $$((20-$(FILLED)))))
	@printf "$(CYAN)$(BOLD)[$(RESET)"
	@printf "$(GREEN)$(BG_GREEN)%*s$(RESET)" $(FILLED) "" | tr ' ' '='
	@printf "%*s" $(EMPTY) "" | tr ' ' '-'
	@printf "$(CYAN)$(BOLD)]$(RESET) "
	@printf "$(YELLOW)$(BOLD)%3d%%$(RESET) " $(PERCENT)
	@printf "$(WHITE)Compiling: $(MAGENTA)$<$(RESET)\n"
endef

# ============================================================================ #
#                                    RULES                                      #
# ============================================================================ #

# Default-Target: Kompiliert das Programm
all: header $(NAME)

# Header-Banner beim Start
header:
	@echo "$(CYAN)‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó$(RESET)"
	@echo "$(CYAN)‚ïë$(YELLOW)$(BOLD)                    COMPILING VIOLENCE                    $(CYAN)‚ïë$(RESET)"
	@echo "$(CYAN)‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù$(RESET)"
	@echo ""

# Linken: Verbindet alle .o Dateien zum finalen Programm
$(NAME): $(OBJS_FULL)
	@echo ""
	@echo "$(BLUE)$(BOLD)üîó Linking objects...$(RESET)"
	@$(CXX) $(CXXFLAGS) $(OBJS_FULL) -o $(NAME)
	@echo ""
	@echo "$(GREEN)‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó$(RESET)"
	@echo "$(GREEN)‚ïë$(BOLD)                  ‚úÖ COMPILATION SUCCESSFUL!                 $(GREEN)‚ïë$(RESET)"
	@echo "$(GREEN)‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£$(RESET)"
	@echo "$(GREEN)‚ïë$(RESET)  $(WHITE)Executable:$(RESET) $(MAGENTA)$(BOLD)./$(NAME)$(RESET)                                    $(GREEN)‚ïë$(RESET)"
	@echo "$(GREEN)‚ïë$(RESET)  $(WHITE)Files compiled:$(RESET) $(YELLOW)$(TOTAL)$(RESET)                                    $(GREEN)‚ïë$(RESET)"
	@echo "$(GREEN)‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù$(RESET)"
	@echo ""

# Kompilieren: Erstellt .o Dateien aus .cpp Dateien
$(OBJS_DIR)/%.o: %.cpp
	@mkdir -p $(OBJS_DIR)
	$(call progress_bar)
	@$(CXX) $(CXXFLAGS) -c $< -o $@

# Clean: L√∂scht Objekt-Dateien
clean:
	@echo "$(YELLOW)üßπ Cleaning object files...$(RESET)"
	@rm -rf $(OBJS_DIR)
	@echo "$(GREEN)‚úÖ Object files removed!$(RESET)"
	@echo ""

# Fclean: L√∂scht alles (Objekte + Binary)
fclean: clean
	@echo "$(YELLOW)üóëÔ∏è  Removing executable...$(RESET)"
	@rm -f $(NAME)
	@echo "$(GREEN)‚úÖ Executable removed!$(RESET)"
	@echo ""

# Re: Alles neu kompilieren
re: fclean all

# ============================================================================ #
#                                    PHONY                                      #
# ============================================================================ #

# Phony-Targets (keine echten Dateien)
.PHONY: all clean fclean re header

